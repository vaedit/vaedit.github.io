<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Vaedit的博客</title>
  
  <subtitle>运维技术博客</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2020-09-22T10:33:58.160Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Vaedit</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>vps编译php报错[ext/fileinfo/libmagic/apprentice.lo]</title>
    <link href="http://example.com/2020/09/22/vps%E7%BC%96%E8%AF%91php%E6%8A%A5%E9%94%99-ext-fileinfo-libmagic-apprentice-lo/"/>
    <id>http://example.com/2020/09/22/vps%E7%BC%96%E8%AF%91php%E6%8A%A5%E9%94%99-ext-fileinfo-libmagic-apprentice-lo/</id>
    <published>2020-09-22T10:31:44.000Z</published>
    <updated>2020-09-22T10:33:58.160Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;p&gt;php编译安装执行make时报错&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span</summary>
        
      
    
    
    
    <category term="故障记录" scheme="http://example.com/categories/%E6%95%85%E9%9A%9C%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="php" scheme="http://example.com/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>AWS-EC2在线磁盘扩容</title>
    <link href="http://example.com/2020/09/22/AWS-EC2%E5%9C%A8%E7%BA%BF%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/"/>
    <id>http://example.com/2020/09/22/AWS-EC2%E5%9C%A8%E7%BA%BF%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/</id>
    <published>2020-09-22T10:29:39.000Z</published>
    <updated>2020-09-22T10:35:07.365Z</updated>
    
    
    <summary type="html">&lt;ol&gt;
&lt;li&gt;&lt;p&gt;首先先给需要扩容的磁盘卷制作快照&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;在控制台修改对应的的磁盘卷，把容量扩大，等待扩容进程走完成&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;查看文件系统&lt;/p&gt;
 &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;file -s /dev/nvme?n* &lt;span class=&quot;comment&quot;&gt;#查看文件系统&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;根据卷是否有分区，来决定是否需要执行扩展分区&lt;/p&gt;
 &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;lsblk &lt;span class=&quot;comment&quot;&gt;#查看磁盘&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME          MAJ:MIN RM SIZE RO TYPE MOUNTPOINT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nvme1n1       259:0    0  30G  0 disk /data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nvme0n1       259:1    0  16G  0 disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;└─nvme0n1p1   259:2    0   8G  0 part /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;└─nvme0n1p128 259:3    0   1M  0 part&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#nvme1n1  没有分区，nvme0n1上有两个分区，有分区的卷需要执行扩展分区扩容&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;growpart /dev/nvme0n1 1 &lt;span class=&quot;comment&quot;&gt;#请注意，设备名称和分区编号之间有空格&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="AWS服务" scheme="http://example.com/categories/AWS%E6%9C%8D%E5%8A%A1/"/>
    
    
    <category term="磁盘扩容" scheme="http://example.com/tags/%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/"/>
    
  </entry>
  
  <entry>
    <title>Linux下制作RPM包工具fpm</title>
    <link href="http://example.com/2020/09/22/Linux%E4%B8%8B%E5%88%B6%E4%BD%9CRPM%E5%8C%85%E5%B7%A5%E5%85%B7fpm/"/>
    <id>http://example.com/2020/09/22/Linux%E4%B8%8B%E5%88%B6%E4%BD%9CRPM%E5%8C%85%E5%B7%A5%E5%85%B7fpm/</id>
    <published>2020-09-22T10:28:57.000Z</published>
    <updated>2020-09-22T10:33:29.120Z</updated>
    
    
      
      
        
        
    <summary type="html">&lt;h2 id=&quot;fpm工具安装&quot;&gt;&lt;a href=&quot;#fpm工具安装&quot; class=&quot;headerlink&quot; title=&quot;fpm工具安装&quot;&gt;&lt;/a&gt;fpm工具安装&lt;/h2&gt;&lt;h3 id=&quot;CentOS-6-x下安装&quot;&gt;&lt;a href=&quot;#CentOS-6-x下安装&quot;</summary>
        
      
    
    
    
    <category term="Linux基础服务" scheme="http://example.com/categories/Linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/"/>
    
    
    <category term="rpm包制作" scheme="http://example.com/tags/rpm%E5%8C%85%E5%88%B6%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>Linux内核调优</title>
    <link href="http://example.com/2020/09/22/Linux%E5%86%85%E6%A0%B8%E8%B0%83%E4%BC%98/"/>
    <id>http://example.com/2020/09/22/Linux%E5%86%85%E6%A0%B8%E8%B0%83%E4%BC%98/</id>
    <published>2020-09-22T10:23:41.000Z</published>
    <updated>2020-09-22T10:25:05.090Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;文件描述符和最大进程数&quot;&gt;&lt;a href=&quot;#文件描述符和最大进程数&quot; class=&quot;headerlink&quot; title=&quot;文件描述符和最大进程数&quot;&gt;&lt;/a&gt;文件描述符和最大进程数&lt;/h2&gt;&lt;h3 id=&quot;ulimit的使用&quot;&gt;&lt;a href=&quot;#ulimit的使用&quot; class=&quot;headerlink&quot; title=&quot;ulimit的使用&quot;&gt;&lt;/a&gt;ulimit的使用&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;ulimit&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#-a 列出所有当前资源极限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#-n 每个进程可以同时打开的最大文件数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#-u 可以运行的最大并发进程数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#-S 设置软限制&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#-H 设置硬限制&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;在命令行直接执行该命令只会在当前shell生效，退出或者新开一个shell都会无效，所以可以加入到全局设置中：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/bin/&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;ulimit -SHn 65535&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /etc/profile&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;有时候为了方便起见，也可以将用户资源的限制统一由一个文件来配置&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;这个文件就是/etc/security/limits.conf，该文件不但能对指定用户的资源进行限制，还能对指定组的资源进行限制。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;* hard nofile 65535&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt;/etc/security/limits.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;* soft nofile 65535&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt;/etc/security/limits.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;* soft nproc 65535&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt;/etc/security/limits.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;* hard nproc 65535&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt;/etc/security/limits.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;需要注意的是，在centos系统中，除了/etc/security/limits.conf文件外，还有一个文件/etc/security/limits.d/20-nproc.conf（centos7.x系统），&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/etc/security/limits.d/90-nproc.conf（centos6.x系统），这个文件中，对nproc设置了一个默认值，&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;并且是针对所有系统用户设置的。而如果在/etc/security/limits.conf文件中也设置了nproc值的话，&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;则会被覆盖，也就是说/etc/security/limits.d/里面的文件的配置会覆盖/etc/security/limits.conf的配置。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;所以最好是删除该文件或者修改或者屏蔽该文件内容：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/bin/sed -i &lt;span class=&quot;string&quot;&gt;&amp;#x27;s/1024/65535/g&amp;#x27;&lt;/span&gt;  /etc/security/limits.d/90-nproc.conf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;或者：&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rm -f /etc/security/limits.d/90-nproc.conf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="系统调优" scheme="http://example.com/categories/%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98/"/>
    
    
    <category term="Linux" scheme="http://example.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Linux历史命令调优</title>
    <link href="http://example.com/2020/09/22/Linux%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4%E8%B0%83%E4%BC%98/"/>
    <id>http://example.com/2020/09/22/Linux%E5%8E%86%E5%8F%B2%E5%91%BD%E4%BB%A4%E8%B0%83%E4%BC%98/</id>
    <published>2020-09-22T10:23:08.000Z</published>
    <updated>2020-09-22T10:25:19.179Z</updated>
    
    
    <summary type="html">&lt;h4 id=&quot;合理使用shell历史记录功能&quot;&gt;&lt;a href=&quot;#合理使用shell历史记录功能&quot; class=&quot;headerlink&quot; title=&quot;合理使用shell历史记录功能&quot;&gt;&lt;/a&gt;合理使用shell历史记录功能&lt;/h4&gt;&lt;p&gt;默认shell命令是存在.bash_history中，且不够详细，通过把以下命令写入到/etc/profile中，可以隐蔽的保存历史命令记录并方便审计。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#history&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;HISTDIR=/usr/share/.&lt;span class=&quot;built_in&quot;&gt;history&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; HISTORY_FILE=&lt;span class=&quot;variable&quot;&gt;$&amp;#123;HISTDIR&amp;#125;&lt;/span&gt;/`date &lt;span class=&quot;string&quot;&gt;&amp;#x27;+%Y-%m-%d&amp;#x27;&lt;/span&gt;`.&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ ! -d &lt;span class=&quot;variable&quot;&gt;$HISTDIR&lt;/span&gt; ];&lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mkdir -p &lt;span class=&quot;variable&quot;&gt;$HISTDIR&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ ! -f &lt;span class=&quot;variable&quot;&gt;$HISTORY_FILE&lt;/span&gt; ];&lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    touch &lt;span class=&quot;variable&quot;&gt;$HISTORY_FILE&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;readonly&lt;/span&gt; PROMPT_COMMAND=&lt;span class=&quot;string&quot;&gt;&amp;#x27;&amp;#123; date &amp;quot;+%Y-%m-%d %T ##### $(who am i |awk -v user=$USER &amp;quot;&amp;#123;print user \&amp;quot; \&amp;quot;\$2\&amp;quot; \&amp;quot;\$5&amp;#125;&amp;quot;) #### $(pwd) #### $(history 1 | &amp;#123; read x cmd; echo &amp;quot;$cmd&amp;quot;; &amp;#125;)&amp;quot;; &amp;#125; &amp;gt;&amp;gt; $HISTORY_FILE&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="系统调优" scheme="http://example.com/categories/%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98/"/>
    
    
    <category term="Linux" scheme="http://example.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Shell并发编程</title>
    <link href="http://example.com/2020/09/22/Shell%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"/>
    <id>http://example.com/2020/09/22/Shell%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/</id>
    <published>2020-09-22T10:21:42.000Z</published>
    <updated>2020-09-22T10:22:35.760Z</updated>
    
    
    <summary type="html">&lt;h4 id=&quot;案例1-通过文件描述符控制并发数&quot;&gt;&lt;a href=&quot;#案例1-通过文件描述符控制并发数&quot; class=&quot;headerlink&quot; title=&quot;案例1 通过文件描述符控制并发数&quot;&gt;&lt;/a&gt;案例1 通过文件描述符控制并发数&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#用fifo处理shell下多进程并发：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#author : vaedit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#date : 2017-8-15&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#需要执行的工作函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;mima&lt;/span&gt;&lt;/span&gt;()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  openssl rand -base64 40 &amp;gt;&amp;gt; ssf.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#判断是否存在fifo文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;  [ -e /tmp/$$.fifo ];&lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  rm -rf /tmp/$$.fifo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#创建$$.fifo 主要是为了防止同名&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fifo_file=/tmp/$$.fifo&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mkfifo &lt;span class=&quot;variable&quot;&gt;$fifo_file&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#把文件表述符fd6和fifo文件绑定&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;exec&lt;/span&gt; 6&amp;lt;&amp;gt;&lt;span class=&quot;string&quot;&gt;&amp;quot;&lt;span class=&quot;variable&quot;&gt;$fifo_file&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;process_num=10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#向fd6中输入10个回车&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ((i=0;i&amp;lt;&lt;span class=&quot;variable&quot;&gt;$process_num&lt;/span&gt;;i++))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt; &amp;gt;&amp;amp;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#处理业务&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ((a=0;a&amp;lt;10;a++))  &lt;span class=&quot;comment&quot;&gt;#这里写10表示业务总条数，比如业务总共要执行100次，就填100&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; -u6 &lt;span class=&quot;comment&quot;&gt;##read -u6命令执行一次，相当于尝试从fd6中获取一行，如果获取不到，则阻塞#获取到了一行后，fd6就少了一行了，开始处理子进程，子进程放在后台执行&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  mima&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  sleep 3  &lt;span class=&quot;comment&quot;&gt;# 暂停3秒，这里是关键点，其实引入管道模拟多线程的关键就是为了这个暂停的3秒（实际上是微大于3秒的），让系统有个缓冲的时间，起到限制所谓并发的进程数量。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &amp;gt;&amp;amp;6  &lt;span class=&quot;comment&quot;&gt;#表示向fd6中输入一行，补充刚才消耗的&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125; &amp;amp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;wait&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;#等待所有的后台子进程结束&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#关闭fd6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;exec&lt;/span&gt; 6&amp;gt;&amp;amp;-&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Shell脚本" scheme="http://example.com/categories/Shell%E8%84%9A%E6%9C%AC/"/>
    
    
    <category term="Shell" scheme="http://example.com/tags/Shell/"/>
    
  </entry>
  
  <entry>
    <title>NFS安装使用</title>
    <link href="http://example.com/2020/09/22/NFS%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/"/>
    <id>http://example.com/2020/09/22/NFS%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/</id>
    <published>2020-09-22T10:17:30.000Z</published>
    <updated>2020-09-22T10:18:11.514Z</updated>
    
    
    <summary type="html">&lt;h4 id=&quot;NFS安装&quot;&gt;&lt;a href=&quot;#NFS安装&quot; class=&quot;headerlink&quot; title=&quot;NFS安装&quot;&gt;&lt;/a&gt;NFS安装&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum install nfs* rpcbind -y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&amp;quot;/ssf *(rw,no_root_squash,no_all_squash,sync)&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt;/etc/exports&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;service rpcbind start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;service nfs start &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chmod 766 /ssf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h4 id=&quot;配置文件详解&quot;&gt;&lt;a href=&quot;#配置文件详解&quot; class=&quot;headerlink&quot; title=&quot;配置文件详解&quot;&gt;&lt;/a&gt;配置文件详解&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vim &amp;#x2F;etc&amp;#x2F;exports &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2F;data&amp;#x2F;lys 192.168.2.0&amp;#x2F;24(rw,no_root_squash,no_all_squash,sync)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="Linux基础服务" scheme="http://example.com/categories/Linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/"/>
    
    
    <category term="NFS" scheme="http://example.com/tags/NFS/"/>
    
  </entry>
  
  <entry>
    <title>iredmail邮件服务器部署</title>
    <link href="http://example.com/2020/09/22/iredmail%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/"/>
    <id>http://example.com/2020/09/22/iredmail%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2/</id>
    <published>2020-09-22T10:14:47.000Z</published>
    <updated>2020-09-22T10:16:54.162Z</updated>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;作者：Vaedit&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;iredmail部署&quot;&gt;&lt;a href=&quot;#iredmail部署&quot; class=&quot;headerlink&quot; title=&quot;iredmail部署&quot;&gt;&lt;/a&gt;iredmail部署&lt;/h2&gt;&lt;h4 id=&quot;一-服务器选型采购&quot;&gt;&lt;a href=&quot;#一-服务器选型采购&quot; class=&quot;headerlink&quot; title=&quot;一 服务器选型采购&quot;&gt;&lt;/a&gt;一 服务器选型采购&lt;/h4&gt;&lt;p&gt;由于国内云厂商默认都禁用smtp25端口，所以需要购买国外地区云服务器，低使用频率推荐至少内存2G以上。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;云厂商&lt;/th&gt;
&lt;th&gt;服务器型号&lt;/th&gt;
&lt;th&gt;配置&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;AWS&lt;/td&gt;
&lt;td&gt;r4.large&lt;/td&gt;
&lt;td&gt;2核16G&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h4 id=&quot;二-iredmail下载安装&quot;&gt;&lt;a href=&quot;#二-iredmail下载安装&quot; class=&quot;headerlink&quot; title=&quot;二 iredmail下载安装&quot;&gt;&lt;/a&gt;二 iredmail下载安装&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;该示例后续所有一级域名都需要按照实际使用域名来修改&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Linux基础服务" scheme="http://example.com/categories/Linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/"/>
    
    
    <category term="iredmail" scheme="http://example.com/tags/iredmail/"/>
    
  </entry>
  
  <entry>
    <title>rsync服务搭建</title>
    <link href="http://example.com/2020/09/22/rsync%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/"/>
    <id>http://example.com/2020/09/22/rsync%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/</id>
    <published>2020-09-22T10:12:29.000Z</published>
    <updated>2020-09-22T10:20:49.852Z</updated>
    
    
    <summary type="html">&lt;h4 id=&quot;server端搭建&quot;&gt;&lt;a href=&quot;#server端搭建&quot; class=&quot;headerlink&quot; title=&quot;server端搭建&quot;&gt;&lt;/a&gt;server端搭建&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;wget  http://rsync.samba.org/ftp/rsync/src/rsync-3.0.7.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tar xf rsync-3.0.7.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; rsync-3.0.7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;./configure --prefix=/usr/&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;/rsync&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;make &amp;amp;&amp;amp; make install&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="linux基础服务" scheme="http://example.com/categories/linux%E5%9F%BA%E7%A1%80%E6%9C%8D%E5%8A%A1/"/>
    
    
    <category term="rsync" scheme="http://example.com/tags/rsync/"/>
    
  </entry>
  
  <entry>
    <title>记录一次因服务器阵列卡坏掉而导致的回档操作</title>
    <link href="http://example.com/2020/09/22/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E5%9B%A0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%98%B5%E5%88%97%E5%8D%A1%E5%9D%8F%E6%8E%89%E8%80%8C%E5%AF%BC%E8%87%B4%E7%9A%84%E5%9B%9E%E6%A1%A3%E6%93%8D%E4%BD%9C/"/>
    <id>http://example.com/2020/09/22/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E5%9B%A0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%98%B5%E5%88%97%E5%8D%A1%E5%9D%8F%E6%8E%89%E8%80%8C%E5%AF%BC%E8%87%B4%E7%9A%84%E5%9B%9E%E6%A1%A3%E6%93%8D%E4%BD%9C/</id>
    <published>2020-09-22T10:09:29.000Z</published>
    <updated>2020-09-22T10:20:14.414Z</updated>
    
    
    <summary type="html">&lt;h4 id=&quot;起因&quot;&gt;&lt;a href=&quot;#起因&quot; class=&quot;headerlink&quot; title=&quot;起因&quot;&gt;&lt;/a&gt;起因&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;周一上午刚到公司便接到策划同事发来的消息，公司某老项目游戏有玩家报登录不上。&lt;/li&gt;
&lt;li&gt;于是便登录相关项目服务器，执行脚本，结果如下图：&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/299a8d666a544ca9b9691af88fb7aa06~tplv-k3u1fbpfcp-zoom-1.image&quot;&gt;&lt;/p&gt;
&lt;p&gt;当时返回无返回结果，及红色框内无返回值。第一直觉便觉得是不是对应服务器网络有问题。&lt;/p&gt;</summary>
    
    
    
    <category term="故障记录" scheme="http://example.com/categories/%E6%95%85%E9%9A%9C%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="Linux" scheme="http://example.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Xtrabackup</title>
    <link href="http://example.com/2020/09/22/Xtrabackup/"/>
    <id>http://example.com/2020/09/22/Xtrabackup/</id>
    <published>2020-09-22T10:01:59.000Z</published>
    <updated>2020-09-22T10:20:59.344Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;安装&quot;&gt;&lt;a href=&quot;#安装&quot; class=&quot;headerlink&quot; title=&quot;安装&quot;&gt;&lt;/a&gt;安装&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;官方文档地址：&lt;a href=&quot;https://www.percona.com/doc/percona-xtrabackup/2.4/&quot;&gt;https://www.percona.com/doc/percona-xtrabackup/2.4/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;yum源安装&quot;&gt;&lt;a href=&quot;#yum源安装&quot; class=&quot;headerlink&quot; title=&quot;yum源安装&quot;&gt;&lt;/a&gt;yum源安装&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;安装Percona源&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm -y&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;安装包&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum install epel-release -y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum install percona-xtrabackup-24 -y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;yum install qpress -y &lt;span class=&quot;comment&quot;&gt;#压缩备份需要&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="数据库" scheme="http://example.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="mysql备份" scheme="http://example.com/tags/mysql%E5%A4%87%E4%BB%BD/"/>
    
  </entry>
  
  <entry>
    <title>contextmanager</title>
    <link href="http://example.com/2020/09/22/%E4%BD%BF%E7%94%A8contextmanager%EF%BC%8C%E8%AE%BE%E7%BD%AE%E4%B8%8A%E4%B8%8B%E6%96%87/"/>
    <id>http://example.com/2020/09/22/%E4%BD%BF%E7%94%A8contextmanager%EF%BC%8C%E8%AE%BE%E7%BD%AE%E4%B8%8A%E4%B8%8B%E6%96%87/</id>
    <published>2020-09-22T09:31:13.000Z</published>
    <updated>2020-09-22T10:26:47.823Z</updated>
    
    
    <summary type="html">&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 使用contextmanager，设置上下文&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;DBTools_V2&lt;/span&gt;():&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;__init__&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;self, host=&lt;span class=&quot;string&quot;&gt;&amp;#x27;192.168.0.188&amp;#x27;&lt;/span&gt;, port=&lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;, db=&lt;span class=&quot;string&quot;&gt;&amp;#x27;xx&amp;#x27;&lt;/span&gt;, user=&lt;span class=&quot;string&quot;&gt;&amp;#x27;xx&amp;#x27;&lt;/span&gt;, passwd=&lt;span class=&quot;string&quot;&gt;&amp;#x27;xx?&amp;#x27;&lt;/span&gt;, charset=&lt;span class=&quot;string&quot;&gt;&amp;#x27;utf8&amp;#x27;&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# 建立连接&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.conn = pymysql.connect(host=host, port=port, db=db, user=user, passwd=passwd, charset=charset)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# 创建游标，操作设置为字典类型&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        self.cur = self.conn.cursor(cursor=pymysql.cursors.DictCursor)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;select_by_parameters&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;self, sql, params=None&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            self.cur.execute(sql, params)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            result = self.cur.fetchall()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; e:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(e)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;update_by_parameters&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;self, sql, params=None&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            count = self.cur.execute(sql, params)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; count&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; e:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            print(e)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@contextmanager&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;create_mysql_connect&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;host=&lt;span class=&quot;string&quot;&gt;&amp;#x27;192.168.0.188&amp;#x27;&lt;/span&gt;, port=&lt;span class=&quot;number&quot;&gt;3306&lt;/span&gt;, db=&lt;span class=&quot;string&quot;&gt;&amp;#x27;xx&amp;#x27;&lt;/span&gt;, user=&lt;span class=&quot;string&quot;&gt;&amp;#x27;xx&amp;#x27;&lt;/span&gt;, passwd=&lt;span class=&quot;string&quot;&gt;&amp;#x27;xx?&amp;#x27;&lt;/span&gt;, charset=&lt;span class=&quot;string&quot;&gt;&amp;#x27;utf8&amp;#x27;&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# with 执行部分&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(&lt;span class=&quot;string&quot;&gt;&amp;quot;开始执行&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    db = DBTools_V2(host=host, port=port, db=db, user=user, passwd=passwd, charset=charset)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# as 赋值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;yield&lt;/span&gt; db&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 执行完代码后的处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    db.conn.commit()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    db.cur.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    db.conn.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="python运维" scheme="http://example.com/categories/python%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>mysql表修复</title>
    <link href="http://example.com/2020/09/22/mysql%E8%A1%A8%E4%BF%AE%E5%A4%8D/"/>
    <id>http://example.com/2020/09/22/mysql%E8%A1%A8%E4%BF%AE%E5%A4%8D/</id>
    <published>2020-09-22T09:17:23.000Z</published>
    <updated>2020-09-22T10:20:36.222Z</updated>
    
    
    <summary type="html">&lt;h2 id=&quot;mysqlcheck&quot;&gt;&lt;a href=&quot;#mysqlcheck&quot; class=&quot;headerlink&quot; title=&quot;mysqlcheck&quot;&gt;&lt;/a&gt;mysqlcheck&lt;/h2&gt;&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;mysqlcheck客户端可以检查和修复MyISAM表。它还可以优化和分析表。mysqlcheck的功能类似myisamchk，但其工作不同。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;主要差别是当mysqld服务器在运行时必须使用mysqlcheck，而myisamchk应用于服务器没有运行时。使用mysqlcheck的好处是不需要停止服务器来检查或修复表。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mysqlcheck为用户提供了一种方便的使用SQL语句CHECK TABLE、REPAIR TABLE、ANALYZE TABLE和OPTIMIZE TABLE的方式。它确定在要执行的操作中使用使用哪个语句，然后将语句发送到要执行的服务器上。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;示例&quot;&gt;&lt;a href=&quot;#示例&quot; class=&quot;headerlink&quot; title=&quot;示例&quot;&gt;&lt;/a&gt;示例&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mysqlcheck -B 指定数据库 -r -S /data/mysql2/mysql2.sock -u root -p&lt;span class=&quot;string&quot;&gt;&amp;#x27;test&amp;#x27;&lt;/span&gt; &amp;gt;&amp;gt; /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/mysqlcheck.log&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="数据库" scheme="http://example.com/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="mysql" scheme="http://example.com/tags/mysql/"/>
    
  </entry>
  
</feed>
